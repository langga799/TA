package com.example.maggokitapp.serviceimport android.app.*import android.content.Contextimport android.content.Intentimport android.media.RingtoneManagerimport android.os.Buildimport android.os.IBinderimport android.widget.Toastimport androidx.core.app.NotificationCompatimport androidx.core.app.NotificationManagerCompatimport com.example.maggokitapp.MonitoringActivityimport com.example.maggokitapp.Rimport com.google.firebase.database.DataSnapshotimport com.google.firebase.database.DatabaseErrorimport com.google.firebase.database.ValueEventListenerimport com.google.firebase.database.ktx.databaseimport com.google.firebase.ktx.Firebaseclass NotificationService : Service() {    override fun onCreate() {        Toast.makeText(this, "Service Running", Toast.LENGTH_SHORT).show()        val reference = Firebase.database.reference.child("berat")        reference.addValueEventListener(object : ValueEventListener {            override fun onDataChange(snapshot: DataSnapshot) {                when {                    snapshot.value.toString().toFloat() >= 5.0 -> {                        createNotification()                    }                }            }            override fun onCancelled(error: DatabaseError) {}        })    }    override fun onBind(p0: Intent?): IBinder? {        return null    }    private fun createNotification() {        val channelID = "Maggot"        val channelName = "MaggotKitApp"        val notificationID = 100        val intent = Intent(this, MonitoringActivity::class.java).apply {            flags = Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TASK        }        val pendingIntent = PendingIntent.getActivity(this, 0, intent, 0)        val alarmSound = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION)        val notificationManagerCompat = this.getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager        val notifBuilder = NotificationCompat.Builder(this, channelID)            .setContentTitle("Maggot Kit App")            .setContentText("Maggot Siap Dipanen & Dipilah")            .setSmallIcon(R.drawable.logo)            .setAutoCancel(true)            .setContentIntent(pendingIntent)            .setSound(alarmSound)        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {            val channel = NotificationChannel(                channelID,                channelName,                NotificationManager.IMPORTANCE_HIGH            )            notifBuilder.setChannelId(channelID)            notificationManagerCompat.createNotificationChannel(channel)        }        NotificationManagerCompat.from(this).notify(notificationID, notifBuilder.build())    }}